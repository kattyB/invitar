<%=render :partial=>"header"%>
<h4>
  <%= "Update Pattern" %>
</h4>
<div style="float: left;padding: 10px;width: 100%;">
  <div style="float: left;width: 60%;">
    <% form_tag   edit_pattern_path, :multipart => true do %>

      <table>
        <tr>
          <td>Country</td>
          <td><%=select "country", "id", @countries.collect {|p| [ p.name, p.id ] }, :selected => @pattern.category.country_id %></td>
        </tr>

        <tr>
          <td>Category</td>
          <td>
            <div id="categories_div" >
              <%=select "category", "id", @categories.collect {|p| [ p.name, p.id ] }, :selected => @pattern.category_id %>
            </div>
            <%=text_field_tag "new_cat"%>
          </td>
        </tr>

        <tr>
          <td>Pattern Image</td>
          <td><input type="file" name="image"></input></td>
        </tr>

        <tr>
          <td colspan="2">
            <br/><br/><br/>
            <input type="submit" value="Update Pattern"></input>
          </td>
        </tr>
      </table>
    <% end %>
  </div>
  <div style="float: left;padding: 10px;width: 30%;">
    <div class="theme_thumbs">
      <span style="float: left;margin-top: 6px;width: 150px;text-align: right;">
        Pattern Image:&nbsp;
      </span><a href="#" class="innerThumb"><%=image_tag(@pattern.image.url(:thumb), :size => "80x70") %></a>
    </div>
  </div>
</div>


<script>
  $('#country_id').change(function(){
    $.ajax({
      type:"get",
      url:"/admin/categories?c_id=" + $('#country_id').val()
    }
  );
  });

  $('#category_id').change(function(){
    $('#new_cat').css('display', 'none');
    if($('#category_id :selected').val() == "New Category")
      $('#new_cat').toggle();
  });
</script>